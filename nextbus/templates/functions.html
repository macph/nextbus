{# Functions for templates #}

{# Footer #}
{% macro footer() -%}
<footer>
  <p>&copy; Ewan Macpherson and data sources, 2017&ndash;19. <a href="{{ url_for('page.about') }}">About this website</a></p>
</footer>
{%- endmacro %}

{# Prints an inline list, using strong tags if required #}
{% macro print_inline(items, strong=true) -%}
{% if items|length == 1 %}
{% if strong %}<strong>{{ items[0] }}</strong>{% else %}{{ items[0] }}{% endif %}
{% elif items|length > 1 %}
{% set next = joiner() %}
{% if strong %}
{% for i in items[:-1] %}{{ next() }}<strong>{{ i }}</strong>{% endfor %} and <strong>{{ items[-1] }}</strong>
{% else %}
{% for i in items[:-1] %}{{ next() }}{{ i }}{% endfor %} and {{ items[-1] }}
{% endif %}
{% else %}
{% endif %}
{%- endmacro %}

{# Prints a list using callers #}
{% macro print_list(items, class=none, name=none) -%}
<ul class="list{% if class %}{{ ' %s'|format(class) }}{% endif %}" {% if name %}id="{{ name }}"{% endif %}>
  {%- for i in items %}
  <li>{{ caller(i) }}</li>
  {%- endfor %}
</ul>
{%- endmacro %}

{# Prints a list of indices from dictionary #}
{% macro print_index(items) -%}
<ul class="list-index">
    {% for name, _ in items|dictsort %}
    <li><a href="#{{ name }}"><span>{{ name }}</span></a></li>
    {% endfor %}
</ul>
{%- endmacro %}

{# Prints the stop indicator #}
{% macro print_stop_indicator(stop, reverse=false, name=none) -%}
<span class="indicator{{ ' indicator-reversed' if reverse else '' }} area-{{ stop.admin_area_ref }}" {% if name %}id="{{ name }}"{% endif %}>
  {% if stop.short_ind != '' -%}
  <span>{{ stop.short_ind }}</span>
  {%- elif stop.stop_type in ['BCT', 'BCS', 'GBCS', 'GCLS', 'GPBS'] -%}
  <img src="{{ url_for('static', filename='img/bus-white.svg') }}" width="28px" alt="Bus stop">
  {%- elif stop.stop_type in ['PLT', 'GTMU'] -%}
  <img src="{{ url_for('static', filename='img/tram-white.svg') }}" width="28px" alt="Tram stop">
  {%- endif %}
</span>
{%- endmacro %}


{% macro stop_description(stop) -%}
{% set dir = {"N": "northbound", "NE": "northeast bound", "E": "eastbound", "SE": "southeast bound",
              "S": "southbound", "SW": "southwest bound", "W": "westbound", "NW": "northwest bound"} %}
{% if stop.street is not none and stop.bearing is not none %}
<strong>{{ stop.street }}</strong>, {{ dir.get(stop.bearing, "") }}
{% elif stop.street is not none %}
<strong>{{ stop.street }}</strong>
{% elif stop.bearing is not none %}
{{ dir.get(stop.bearing, "")|capitalize }}
{% endif %}
{%- endmacro %}
